{% extends "base.html" %}
{% block page_content %}
<div class="page_header">
  <h1>正在自动应答</h1>
</div>
<div class="page_content">
  <textarea id="logBox" readonly placeholder="等待日志输出..."></textarea>
</div>
{% endblock %}
{% block style %}
{{ super() }}
<style>
  #logBox {
           width: 100%;
            height: 80%;
            margin-top: 20px;
            font-family: monospace;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: auto;
            resize: none;
        }
  </style>
{% endblock %}
{% block scripts %}
{{ super() }}
<script>
  const logBox = document.getElementById("logBox");

    function fetchLog() {
        fetch("/get_front_log")
            .then(response => response.json())
            .then(data => {
                if (data.logs !== "###UNDEFINED###") {
                    logBox.value += data.logs + "\n";
                    logBox.scrollTop = logBox.scrollHeight; // 自动滚动到底部
                }
            })
            .catch(err => {
                console.error("获取日志失败:", err);
            });
    }

    // 每秒轮询一次日志
    setInterval(fetchLog, 50);
</script>
{% endblock %}